{"version":3,"sources":["game.ts"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["/// <reference path=\"ArgyleEngine.ts\"/>\r\n/// <reference path=\"Player.ts\"/>\r\n/// <reference path=\"NPC.ts\"/>\r\n/// <reference path=\"Teleporter.ts\"/>\r\n/// <reference path=\"Arrow.ts\"/>\r\nclass SneakySnakeGame {\r\n    public world: Building;\r\n    public currentFloor: number;\r\n    public floorSize: number;\r\n    public renderer: Renderer;\r\n    public assetmanager: AssetManager;\r\n    public staticObjs: Array<Obj>; // No tick calls\r\n    public dynamicObjs: Array<Obj>; // Tick calls\r\n    public interval: number = 15; // 15ms between frames, 66.6666666666667 frames/second\r\n    public tickID: any; // ID to clear for tick function when restarting game\r\n    public player: Player;\r\n    public input: Input;\r\n    public collisionMap;\r\n    private tempTick;\r\n    private tempi;\r\n    public NPCs: Array<NPC>;\r\n    private numNPCNextFloor: number;\r\n    private currTeleporter: Teleporter;\r\n\tpublic fps: number = 0;\r\n\tpublic lastFPS: number = 0;\r\n\tpublic fpsID: NodeJS.Timer;\r\n\tprivate bFPS: boolean = false;\r\n\tpublic muted: boolean = false;\r\n\tpublic paused: boolean = true;\r\n\tprivate cheated: boolean = false;\r\n\tpublic arrows: Array<Arrow>;\r\n\r\n    private setupFloor() {\r\n        this.player.pos = gridToScreen(1, 1);\r\n        this.player.sDestination = gridToScreen(1, 1);\r\n        this.player.gDestination = new Vector2(1, 1);\r\n        this.player.previousLoc = [new Vector2(1, 1)];\r\n        for (var i = 0; i < this.player.following.length + 1; i++)\r\n            this.player.previousLoc.push(new Vector2(1, 1));\r\n        this.player.animMan.gotoNamedAnim(\"playerIdleR\");\r\n\r\n        // Set up floor tiles\r\n        var floor = this.world.floors[this.currentFloor];\r\n        this.staticObjs = [];\r\n        for (var y = 0; y < floor.grid.length; y++) {\r\n            for (var x = 0; x < floor.grid[y].length; x++) {\r\n                var screen_coords = gridToScreen(x, y);\r\n                if (floor.grid[x][y].type == RTypes.FLOOR) {\r\n                    var tile = new FloorTile(screen_coords.x, screen_coords.y, [this.assetmanager.anims[\"floor\"]]);\r\n                    tile.setZ(-1);\r\n                    this.staticObjs.push(tile);\r\n                } else if (floor.grid[x][y].type == RTypes.WALL) {\r\n                    this.staticObjs.push(new WallTile(screen_coords.x, screen_coords.y, [this.assetmanager.anims[\"wall\"]]));\r\n                } else if (floor.grid[x][y].type == RTypes.DOOR) {\r\n                    this.staticObjs.push(new FloorTile(screen_coords.x, screen_coords.y, [this.assetmanager.anims[\"floor\"]]));\r\n                }\r\n            }\r\n        }\r\n\r\n        // Spawn teleporter to next level\r\n        tempx = Math.floor(Math.random() * this.floorSize);\r\n        tempy = Math.floor(Math.random() * this.floorSize);\r\n        while (floor.grid[tempx][tempy].type == RTypes.WALL) {\r\n            tempx = Math.floor(Math.random() * this.floorSize);\r\n            tempy = Math.floor(Math.random() * this.floorSize);\r\n        }\r\n        this.tempi = gridToScreen(tempx, tempy);\r\n        this.currTeleporter = new Teleporter(this.tempi.x, this.tempi.y, [this.assetmanager.anims[\"teleporter\"]]);\r\n\r\n        // Spawn NPC's\r\n        var tempx = Math.floor(Math.random() * this.floorSize);\r\n        var tempy = Math.floor(Math.random() * this.floorSize);\r\n\r\n        // Move followers (if any) to 1,1\r\n        var tempNPC: NPC[] = [];\r\n        for (var i = 0; i < this.NPCs.length; i++)\r\n            if (this.NPCs[i].bFollowing) {\r\n                this.NPCs[i].pos = gridToScreen(1, 1);\r\n                tempNPC.push(this.NPCs[i]);\r\n            }\r\n\r\n        this.NPCs = tempNPC;\r\n\r\n        // Check if colliding with anything and if not then place\r\n        for (var i: number = randIntBetween(this.numNPCNextFloor, this.numNPCNextFloor - 3); i > 0; i--) {\r\n            this.tempi = Vector2.randVector2(this.floorSize, this.floorSize);\r\n            while (this.collisionMap[this.currentFloor][this.tempi.y][this.tempi.x].animMan.anims[this.collisionMap[this.currentFloor][this.tempi.y][this.tempi.x].animMan.currentAnim].name === \"filled\"\r\n                || collide(this.tempi, this.NPCs)\r\n                || gridToScreen(this.tempi).equals(this.currTeleporter.pos)\r\n                || (this.tempi.x < 6 && this.tempi.y == 1)\r\n                || (this.tempi.x == 1 && this.tempi.y < 6)) {\r\n                this.tempi = Vector2.randVector2(this.floorSize, this.floorSize);\r\n            }\r\n\r\n            this.NPCs.push(new NPC(gridToScreen(this.tempi), this.tempi, 5,\r\n                [this.assetmanager.anims[\"npcAll\"],\r\n                    this.assetmanager.anims[\"npcFollowAnim\"],\r\n                    this.assetmanager.anims[\"npcIdleDSeen\"],\r\n                    this.assetmanager.anims[\"npcIdleLSeen\"],\r\n                    this.assetmanager.anims[\"npcIdleUSeen\"],\r\n                    this.assetmanager.anims[\"npcIdleRSeen\"]]));\r\n        }\r\n    }\r\n\r\n    public restartGame() {\r\n        // Stop the tick function from ticking\r\n        clearInterval(this.tickID);\r\n\t\tclearInterval(this.fpsID);\r\n\r\n        // Make new world\r\n        this.world = this.worldGen();\r\n\t\t//this.viewWorld(this.world);\r\n\r\n        // Reset everything\r\n        this.staticObjs = [];\r\n        this.dynamicObjs = [];\r\n        this.collisionMap = this.world.collisionMap;\r\n        this.numNPCNextFloor = 3;\r\n        this.NPCs = [];\r\n        this.currentFloor = 0;\r\n        this.input.keyPresses = [];\r\n        this.cheated = false;\r\n\r\n        // Run the function to start a new game\r\n        this.startGame();\r\n        if (!this.paused)\r\n            this.assetmanager.audio.main.play();\r\n    }\r\n\r\n    public worldGen(): Building {\r\n        // Makes a new world\r\n        return new Building(this.floorSize, this.assetmanager);\r\n    }\r\n\r\n    public viewWorld(w: Building): void {\r\n        var wall: string = \"id ='wall\";\r\n        var door: string = \"id ='door\"\r\n        $(\".output p\").remove();\r\n        for (var y: number = this.floorSize; y >= 0; y--) {\r\n            var outP: string = \"<p>\";\r\n            for (var x: number = 0; x <= this.floorSize; x++) {\r\n                outP += \"<span class='tileType\" + ((w.floors[0].grid[x][y].wall) ? (w.floors[0].grid[x][y].door) ? \"02\" : \"01\" : \"00\") + \"'\" + \" \" + ((w.floors[0].grid[x][y].wall) ? (w.floors[0].grid[x][y].door) ? door : wall : \"\") + \"'>\";\r\n                outP += (w.floors[0].grid[x][y].wall) ? (w.floors[0].grid[x][y].door) ? \"02\" : \"01\" : \"00\";\r\n                outP += \"</span>\";\r\n            }\r\n            outP += \"</p>\";\r\n            $(\".output\").prepend(outP);\r\n            outP = \"\";\r\n        }\r\n\t\t$(\".output p\").css({\r\n\t\t\tmargin: \"0px\"\r\n\t\t});\r\n        $(\".tileType00\").css({\r\n            color: \"black\"\r\n        });\r\n        $(\".tileType01\").css({\r\n            color: \"#6C7A89\",\r\n            backgroundColor: \"#6C7A89\"\r\n        });\r\n        $(\".tileType02\").css({\r\n            backgroundColor: \"#CF000F\",\r\n            color: \"#CF000F\"\r\n        });\r\n    }\r\n\r\n    public tick(): void {\r\n        //game logic loop\r\n\t\tthis.fps++;\r\n\r\n        // Resets world if player is on a teleporter and thus needs to go to the next level\r\n        if (this.player.pos.equals(this.player.sDestination) && this.player.pos.equals(this.currTeleporter.pos)) {\r\n            this.currentFloor++;\r\n            this.numNPCNextFloor += randIntBetween(1, 3);\r\n            this.setupFloor();\r\n            return;\r\n        }\r\n\r\n        // Create array to put all objects in\r\n        this.tempTick = this.staticObjs.concat(this.dynamicObjs).concat(this.NPCs).concat(this.currTeleporter);\r\n        this.tempTick.push(this.player);\r\n\r\n        // show collision map\r\n        //var moreTemp = [];\r\n        //for (var i = 0; i < this.collisionMap[this.currentFloor].length; i++) {\r\n        //    moreTemp = this.collisionMap[this.currentFloor][i];\r\n        //    this.tempTick = this.tempTick.concat(moreTemp.slice());\r\n        //}\r\n        // end show collision map\r\n        \r\n        // Tick player\r\n        this.player.tick(this.input, this.collisionMap);\r\n\r\n        // Tick NPC's, if any can see the player, kill the player\r\n        for (this.tempi = 0; this.tempi < this.NPCs.length; this.tempi++) {\r\n            this.NPCs[this.tempi].tick(this.input, this.player, this.collisionMap[this.currentFloor]);            \r\n            if (this.NPCs[this.tempi].seen) {\r\n                if (this.player.pos.equals(this.player.sDestination))\r\n\t\t\t\t\tthis.player.health -= 1;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Disallows the player from moving through walls\r\n        if (this.collisionMap[this.currentFloor][this.player.gDestination.y][this.player.gDestination.x].animMan.anims[0].name !== \"filled\") {\r\n            this.player.bCanLerp = true;\r\n\t\t}\r\n        else {\r\n            this.player.bCanLerp = false;\r\n\t\t\tfor (var x: number = 0; x < 4; x++)\r\n                if (this.arrows[x].animMan.currentAnim == 1)\r\n                    this.arrows[x].no();\r\n\t\t}\r\n\r\n        // Add arrows to be rendered with the updated anim\r\n        this.tempTick = this.tempTick.concat(this.arrows);\r\n\r\n        // Render everything\r\n        this.renderer.draw(this.tempTick, this.assetmanager.anims, (this.bFPS) ? this.lastFPS : -1);\r\n\r\n\t\t// Draw the \"press p to pause\"\r\n\t\t//this.renderer.ctx.fillStyle = \"#FFFFFF\";\r\n\t\t//this.renderer.ctx.font = \"1em Inconsolata\";\r\n\t\t//this.renderer.ctx.fillText(\"Press p to pause\", 10, 20);\r\n\r\n        // Clear inputs\r\n        this.input.mouseClicked = false;\r\n\r\n        // Check end game (player has no health)\r\n        if (this.player.health <= 0) {\r\n            clearInterval(this.tickID);\r\n            clearInterval(this.fpsID);\r\n\r\n            this.assetmanager.audio.main.pause();\r\n            this.assetmanager.audio.seen.play();\r\n\r\n            var that = this;\r\n            var highscore: number[] = [];\r\n            var sHighscore = \"[]\";\r\n\r\n            if (typeof (localStorage) !== \"undefined\") {\r\n                // Sort highscore, check if you cheated, save highscore\r\n                if (!this.cheated)\r\n                    if (typeof (localStorage[\"highscore\"]) == \"undefined\") {\r\n                        highscore = [that.player.following.length];\r\n                    } else {\r\n                        highscore = JSON.parse(localStorage.getItem(\"highscore\") || \"0\");\r\n                        highscore.push(that.player.following.length);\r\n                        highscore = highscore.sort(function (a, b) { return a - b }); // The function allows the sort to be on numbers instead of strings... I know it's dumb but that's how it works\r\n                    }\r\n                else {\r\n                    highscore = JSON.parse(localStorage.getItem(\"highscore\") || \"0\");\r\n                }\r\n                // Don't let it get too long, there's only so much space in localstorage\r\n                if (highscore.length > 5)\r\n                    highscore = highscore.splice(1, highscore.length - 1);\r\n                // Convert to string and save\r\n                sHighscore = JSON.stringify(highscore);\r\n                localStorage.setItem(\"highscore\", sHighscore);\r\n            }\r\n\t\t\t// Show stuff on screen\r\n            setTimeout(function () {\r\n                that.renderer.ctx.drawImage(that.assetmanager.anims[\"gameOver\"].image, (gridToScreen(-1, 5).x - 18), gridToScreen(-1, 5).y);\r\n                that.renderer.ctx.fillStyle = \"#DD1321\";\r\n                that.renderer.ctx.font = \"2.5em Inconsolata\";\r\n\t\t\t\tif (!that.cheated)\r\n\t\t\t\t\tthat.renderer.ctx.fillText(\"Score: \" + that.player.following.length, that.renderer.canvas.width / 2.4, that.renderer.canvas.height / 2 + 30);\r\n\t\t\t\telse\r\n                    that.renderer.ctx.fillText(\"Cheater: \" + that.player.following.length, that.renderer.canvas.width / 2.4, that.renderer.canvas.height / 2 + 30);\r\n                sHighscore = (typeof (localStorage) !== \"undefined\") ? \"\"+highscore[highscore.length - 1] : \"\"+that.player.following.length;\r\n                that.renderer.ctx.fillText(\"Highscore: \" + sHighscore, that.renderer.canvas.width / 2.8, that.renderer.canvas.height / 2 + 100);\r\n                that.renderer.ctx.drawImage(that.assetmanager.anims[\"tapToRestart\"].image, 386, 220, that.assetmanager.anims[\"tapToRestart\"].frameSize.x / 2, that.assetmanager.anims[\"tapToRestart\"].frameSize.y / 2);\r\n            }, 400);\r\n\t\t}\r\n    }\r\n\r\n    public startGame(): void {\r\n        // Create the player\r\n        var playerLocation: Vector2 = gridToScreen(1, 1);\r\n        this.player = new Player(playerLocation.x, playerLocation.y, [this.assetmanager.anims[\"playerIdleR\"], this.assetmanager.anims[\"playerIdleD\"], this.assetmanager.anims[\"playerIdleU\"], this.assetmanager.anims[\"playerWalkR\"], this.assetmanager.anims[\"playerWalkD\"], this.assetmanager.anims[\"playerWalkU\"]]);\r\n        \r\n        this.setupFloor();\r\n\r\n        // Now you see the game\r\n        $(\"#game\").zoomTo({ \"scalemode\": \"both\" });\r\n\r\n        // Start tick function\r\n        var self = this;\r\n        this.tickID = setInterval(function () { self.tick() }, this.interval);\r\n\t\tthis.fpsID = setInterval(function () {\r\n\t\t\tself.lastFPS = self.fps;\r\n\t\t\tself.fps = 0;\r\n\t\t}, 1000);\r\n    }\r\n\r\n    public unsubscribeClick() {\r\n        $(this.renderer.canvas).unbind(\"click\");\r\n    }\r\n\r\n    constructor() {\r\n        this.renderer = new Renderer();\r\n        this.assetmanager = new AssetManager(this.renderer.ctx, this.renderer.canvas);\r\n        this.currentFloor = 0;\r\n        this.floorSize = 15;\r\n        this.world = this.worldGen();\r\n        //this.viewWorld(this.world);\r\n        this.staticObjs = [];\r\n        this.dynamicObjs = [];\r\n        this.collisionMap = this.world.collisionMap;\r\n        this.numNPCNextFloor = 3;\r\n        this.NPCs = [];\r\n\r\n        var that = this;\r\n        \r\n        // Bind inputs\r\n        this.input = new Input;\r\n        this.arrows = [];\r\n        this.arrows[Direction.DL] = new Arrow(gridToScreen(8, 17), [this.assetmanager.anims[\"arrowDownLeft\"], this.assetmanager.anims[\"arrowDownLeftPress\"], this.assetmanager.anims[\"arrowDownLeftNo\"]]);\r\n        this.arrows[Direction.DR] = new Arrow(gridToScreen(17, 8), [this.assetmanager.anims[\"arrowDownRight\"], this.assetmanager.anims[\"arrowDownRightPress\"], this.assetmanager.anims[\"arrowDownRightNo\"]]);\r\n        this.arrows[Direction.UL] = new Arrow(gridToScreen(-3, 6), [this.assetmanager.anims[\"arrowUpLeft\"], this.assetmanager.anims[\"arrowUpLeftPress\"], this.assetmanager.anims[\"arrowUpLeftNo\"]]);\r\n        this.arrows[Direction.UR] = new Arrow(gridToScreen(6, -3), [this.assetmanager.anims[\"arrowUpRight\"], this.assetmanager.anims[\"arrowUpRightPress\"], this.assetmanager.anims[\"arrowUpRightNo\"]]);\r\n\r\n        //$(this.renderer.canvas).mousedown(function (e) { that.input.mousedown(e); });\r\n        $(this.renderer.canvas).mousedown(function (e) {\r\n            that.input.mousedown(e);\r\n            if (that.player.health <= 0) {\r\n                that.restartGame();\r\n            } else if (that.input.mouseDownPos.x < window.outerWidth / 2) {\r\n                if (that.input.mouseDownPos.y < window.outerHeight / 2) {\r\n\t\t\t\t\tthat.input.keyPresses.push(\"a\");\r\n\t\t\t\t\tthat.arrows[Direction.UL].press();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthat.input.keyPresses.push(\"s\");\r\n\t\t\t\t\tthat.arrows[Direction.DL].press();\r\n\t\t\t\t}\r\n            } else {\r\n                if (that.input.mouseDownPos.y < window.outerHeight / 2) {\r\n\t\t\t\t\tthat.input.keyPresses.push(\"w\");\r\n\t\t\t\t\tthat.arrows[Direction.UR].press();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthat.input.keyPresses.push(\"d\");\r\n\t\t\t\t\tthat.arrows[Direction.DR].press();\r\n\t\t\t\t}\r\n\t\t\t}\r\n        });\r\n\r\n        $(this.renderer.canvas).mouseup(function (e) {\r\n            that.input.mouseup(e);\r\n            if (that.input.mouseUpPos.x < window.outerWidth / 2) {\r\n                if (that.input.mouseUpPos.y < window.outerHeight / 2)\r\n                    that.arrows[Direction.UL].norm();\r\n                else\r\n                    that.arrows[Direction.DL].norm();\r\n            }\r\n            else {\r\n                if (that.input.mouseUpPos.y < window.outerHeight / 2)\r\n                    that.arrows[Direction.UR].norm();\r\n                else {\r\n                    that.arrows[Direction.DR].norm();\r\n                }\r\n            }\r\n        });\r\n\r\n        //$(this.renderer.canvas).click(function (e) { that.input.click(e); });\r\n        $(window).keyup(function (e) {\r\n            e.preventDefault();\r\n\t\t\tif (!that.paused) {\r\n                if (e.which == 87 || e.which == 38)\r\n                    that.arrows[Direction.UR].norm();\r\n                else if (e.which == 65 || e.which == 37)\r\n\t\t\t\t\tthat.arrows[Direction.UL].norm();\r\n                else if (e.which == 83 || e.which == 40)\r\n\t\t\t\t\tthat.arrows[Direction.DL].norm();\r\n                else if (e.which == 68 || e.which == 39)\r\n\t\t\t\t\tthat.arrows[Direction.DR].norm();\r\n\t\t\t}\r\n\t\t});\r\n\r\n        $(window).keydown(function (e) {\r\n            // Allowed to happen when paused\r\n            e.preventDefault();\r\n\t\t\tif (e.which == 80) {// P\r\n\t\t\t\t$(\"#back\").hide();\r\n                $(\"#text-wrapper\").hide();\r\n\t\t\t\tthat.paused = !that.paused;\r\n\t\t\t\tif (that.paused) {\r\n\t\t\t\t\t$(\"#game\").hide();\r\n                    $(\"#menu\").show();\r\n                    $(\"#play\").hide();\r\n                    $(\"#resume\").show();\r\n                    $(\"#restart\").show();\r\n                    $(\"#pause\").hide();\r\n                    $(\"#menu\").zoomTo({ \"scalemode\": \"both\" });\r\n\t\t\t\t\tthat.assetmanager.audio.main.pause();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#game\").show();\r\n                    $(\"#menu\").hide();\r\n                    $(\"#pause\").show();\r\n                    $(\"#game\").zoomTo({ \"scalemode\": \"both\" });\r\n                    if (!that.muted) that.assetmanager.audio.main.play();\r\n\t\t\t\t}\r\n\t\t\t} else if (e.which == 77) { // M\r\n\t\t\t\tif (that.assetmanager.audio.main.paused) {\r\n\t\t\t\t\tthat.assetmanager.audio.main.play();\r\n\t\t\t\t\tthat.muted = false;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthat.assetmanager.audio.main.pause();\r\n\t\t\t\t\tthat.muted = true;\r\n\t\t\t\t}\r\n\t\t\t} else if (e.which == 73) { // I\r\n\t\t\t\t$(\"#menu\").hide();\r\n\t\t\t\t$(\"#game\").hide();\r\n\t\t\t\t$(\"#back\").show();\r\n\t\t\t\t$(\"#text-wrapper\").show();\r\n                that.paused = true;\r\n                $(\"#pause\").hide();\r\n\t\t\t}\r\n\r\n\t\t\t// Not allowed to happen when paused\r\n\t\t\tif (!that.paused) {\r\n                if (e.which == 87 || e.which == 38) {\r\n                    that.input.keyPresses.push(\"w\");\r\n                    that.arrows[Direction.UR].press();\r\n\t\t\t\t}\r\n                else if (e.which == 65 || e.which == 37) {\r\n                    that.input.keyPresses.push(\"a\");\r\n                    that.arrows[Direction.UL].press();\r\n\t\t\t\t}\r\n                else if (e.which == 83 || e.which == 40) {\r\n                    that.input.keyPresses.push(\"s\");\r\n                    that.arrows[Direction.DL].press();\r\n\t\t\t\t}\r\n                else if (e.which == 68 || e.which == 39) {\r\n                    that.input.keyPresses.push(\"d\");\r\n                    that.arrows[Direction.DR].press();\r\n\t\t\t\t}\r\n\t\t\t\telse if (e.which == 82) // R //\r\n                    that.restartGame();\r\n                else if (e.which == 70) // F\r\n\t\t\t\t\tthat.bFPS = !that.bFPS;\r\n\t\t\t\telse if (e.which == 76) { // L this is for testing only! use to increase score by one, the game knows you're cheating and you don't get a high score\r\n\t\t\t\t\tvar hi = new NPC(gridToScreen(1, 1), new Vector2(1, 1), 5, [that.assetmanager.anims[\"npcFollowAnim\"]]);\r\n\t\t\t\t\tif (that.player.following.length >= that.player.previousLoc.length - 1)\r\n\t\t\t\t\t\tthat.player.previousLoc = that.player.previousLoc.concat(new Vector2(1, 1));\r\n\t\t\t\t\thi.setfollowIndex(that.player.following.length);\r\n\t\t\t\t\thi.bFollowing = true;\r\n\t\t\t\t\tthat.NPCs = that.NPCs.concat(hi);\r\n\t\t\t\t\tthat.player.following = that.player.following.concat(that.NPCs[that.NPCs.length - 1]);\r\n\t\t\t\t\tthat.player.speed += that.player.speedBoost;\r\n\t\t\t\t\tthat.cheated = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n        });\r\n    }\r\n}\r\n$(function game(): void {\r\n    var game = new SneakySnakeGame();\r\n    // Start game when all assets are loaded\r\n    $(\"body\").on(\"assetsFinished\", function () {\r\n        $(\"#game\").hide();\r\n        $(\"#menu\").show();\r\n        $(\"#menu\").zoomTo({ \"scalemode\": \"both\" });\r\n        game.startGame();\r\n    });\r\n\r\n\tfunction PLAYGAME(): void {\r\n        $(\"#menu\").hide();\r\n        $(\"#play\").hide();\r\n        $(\"#resume\").hide();\r\n        $(\"#restart\").hide();\r\n\t\t$(\"#game\").show();\r\n        $(\"#back\").hide();\r\n        $(\"#pause\").show();\r\n        $(\"#text-wrapper\").hide();\r\n        $(\"#game\").zoomTo({\"scalemode\": \"both\"});\r\n\t\tif (!game.muted)\r\n\t\t\tgame.assetmanager.audio.main.play();\r\n\t\tgame.paused = false;\r\n    }\r\n\r\n    $(\"#play\").click(function () {\r\n        PLAYGAME();\r\n    });\r\n\r\n    $(\"#resume\").click(function () {\r\n        PLAYGAME();\r\n    });\r\n\r\n\t$(\"#restart\").click(function () {\r\n\t\tgame.restartGame();\r\n\t\tPLAYGAME();\r\n    });\r\n    \r\n    $(\"#pause\").click(function () {\r\n        $(\"#back\").hide();\r\n        $(\"#text-wrapper\").hide();\r\n        game.paused = !game.paused;\r\n        if (game.paused) {\r\n            $(\"#game\").css({ \"display\": \"none\" });\r\n            $(\"#menu\").show();\r\n            $(\"#play\").hide();\r\n            $(\"#resume\").show();\r\n            $(\"#restart\").show();\r\n            $(\"#menu\").zoomTo({ \"scalemode\": \"both\" });\r\n            game.assetmanager.audio.main.pause();\r\n        } else {\r\n            $(\"#game\").show();\r\n            $(\"#menu\").hide();\r\n            $(\"#game\").zoomTo({ \"scalemode\": \"both\" });\r\n            if (!game.muted) game.assetmanager.audio.main.play();\r\n        }    \r\n    });\r\n\t\r\n\t$(\"#info\").click(function () {\r\n\t\t$(\"#menu\").hide();\r\n\t\t$(\"#game\").hide();\r\n\t\t$(\"#back\").show();\r\n        $(\"#text-wrapper\").show();\r\n        $(\"#text-wrapper\").zoomTo({ \"scalemode\": \"both\" });\r\n\t});\r\n\r\n\t$(\"#back\").click(function () {\r\n\t\t$(\"#menu\").show();\r\n\t\t$(\"#back\").hide();\r\n        $(\"#text-wrapper\").hide();\r\n        $(\"#menu\").zoomTo({ \"scalemode\": \"both\" });\r\n\t});\r\n\r\n    \r\n});"],"sourceRoot":"SS/SS/js"}